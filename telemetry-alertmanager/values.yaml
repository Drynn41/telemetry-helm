alertmanager:
  replicaCount: 1
  image: "prom/alertmanager"
  services:
    alertmanager:
      type: ClusterIP
      port: 9093
  resources:
      requests:
        memory: "256M"       # Le conteneur demande au moins 1 Go de RAM
        cpu: "500m"         # Le conteneur demande 0.5 vCPU (un demi processeur)
      limits:
        memory: "512M"       # Le conteneur ne pourra pas utiliser plus de 2 Go de RAM
        cpu: "500m"            # Le conteneur ne pourra pas utiliser plus de 1 vCPU (un processeur complet)
  args:
    - "--config.file=/etc/alertmanager/alertmanager.yml"
  config: |
    ---
    global:
      # The smarthost and SMTP sender used for mail notifications.
      smtp_smarthost: 'localhost:25'
      smtp_from: 'alertmanager@linuxtime.fr'

    route:
      receiver: 'discord-notifier'
      group_wait: 10s
      group_interval: 5m
      repeat_interval: 30m
      group_by: [instance,alertname]

    receivers:
      - name: 'discord-notifier'
        webhook_configs:
          - url: 'http://discord-proxy.telemetry.svc.cluster.local:8080/webhook'
            send_resolved: true


discordproxy:
  replicaCount: 1

  image:
    repository: python
    tag: "3.11"
    pullPolicy: IfNotPresent

  discordWebhookUrl: "https://discord.com/api/webhooks/1160481355843514388/_DT_mu0uV9vA2sBEZFOgkgouAmMUz4hya_2_TETDZZFARGrM1lgSQJH7KliBayp31-f3"

  service:
    type: ClusterIP
    port: 8080

